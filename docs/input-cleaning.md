# การทำความสะอาดข้อความผู้ใช้ (User Input Cleaning)

## วัตถุประสงค์

ฟังก์ชัน `cleanInput` ถูกออกแบบมาเพื่อทำความสะอาดและมาตรฐานข้อความที่ผู้ใช้ป้อนเข้ามา โดยรองรับหลายภาษาและอักขระพิเศษต่างๆ

## การทำงานของฟังก์ชัน

```typescript
export const cleanInput = (input: string): string => {
  if (!input) return "";

  return (
    input
      // ลบเครื่องหมายคำถามที่อยู่ท้ายข้อความ
      .replace(/\?+$/, "")
      // ลบช่องว่างที่อยู่หน้าและท้ายข้อความ
      .trim()
      // ลบช่องว่างที่ซ้ำกัน
      .replace(/\s+/g, " ")
      // ลบอักขระพิเศษที่ไม่จำเป็น แต่ยังคงตัวอักษรภาษาต่างๆ
      .replace(/[^\p{L}\p{N}\s.,!?]/gu, "")
      // แปลงข้อความเป็นตัวพิมพ์เล็ก
      .toLowerCase()
  );
};
```

## รายละเอียดการทำความสะอาด

1. **การตรวจสอบค่าว่าง**

   - ถ้าข้อความเป็นค่าว่างหรือ null จะคืนค่าเป็นสตริงว่าง

2. **การลบเครื่องหมายคำถามท้ายข้อความ**

   - ใช้ regex `/\?+$/` เพื่อลบเครื่องหมายคำถามที่อยู่ท้ายข้อความ
   - รองรับเครื่องหมายคำถามหลายตัว เช่น "ข้อความ???" จะกลายเป็น "ข้อความ"

3. **การลบช่องว่าง**

   - ใช้ `trim()` เพื่อลบช่องว่างที่อยู่หน้าและท้ายข้อความ
   - ใช้ regex `/\s+/g` เพื่อรวมช่องว่างที่ซ้ำกันให้เหลือเพียงช่องว่างเดียว

4. **การกรองอักขระพิเศษ**

   - ใช้ Unicode properties เพื่อรองรับตัวอักษรทุกภาษา:
     - `\p{L}`: ตัวอักษรทุกภาษา (Letters)
     - `\p{N}`: ตัวเลข (Numbers)
   - อนุญาตให้ใช้เครื่องหมายวรรคตอนพื้นฐาน: `. , ! ?`
   - ใช้ flag `u` เพื่อรองรับ Unicode properties

5. **การแปลงตัวพิมพ์**
   - แปลงข้อความทั้งหมดเป็นตัวพิมพ์เล็กด้วย `toLowerCase()`

## ตัวอย่างการใช้งาน

```typescript
// ภาษาไทย
cleanInput("สวัสดี ครับ???"); // "สวัสดี ครับ"

// ภาษาอังกฤษ
cleanInput("Hello  World!"); // "hello world!"

// ภาษาญี่ปุ่น
cleanInput("こんにちは　世界"); // "こんにちは 世界"

// ภาษาจีน
cleanInput("你好，世界！"); // "你好，世界！"

// ภาษา Hindi
cleanInput("नमस्ते दुनिया"); // "नमस्ते दुनिया"

// ผสมหลายภาษา
cleanInput("Hello สวัสดี こんにちは 你好"); // "hello สวัสดี こんにちは 你好"
```

## ข้อควรระวัง

1. **การแปลงตัวพิมพ์เล็ก**

   - ฟังก์ชันจะแปลงทุกตัวอักษรเป็นตัวพิมพ์เล็ก
   - ควรพิจารณาว่าต้องการรักษาตัวพิมพ์ใหญ่หรือไม่

2. **การลบอักขระพิเศษ**

   - อักขระพิเศษที่ไม่ใช่ตัวอักษร ตัวเลข หรือเครื่องหมายวรรคตอนพื้นฐานจะถูกลบออก
   - ควรพิจารณาว่าต้องการอนุญาตให้ใช้อักขระพิเศษเพิ่มเติมหรือไม่

3. **การรองรับภาษา**
   - ฟังก์ชันรองรับตัวอักษร Unicode ทุกภาษา
   - ควรทดสอบกับภาษาที่ใช้บ่อยในแอพพลิเคชัน

## การปรับแต่งเพิ่มเติม

หากต้องการปรับแต่งการทำความสะอาดข้อความ สามารถทำได้โดย:

1. เพิ่มอักขระพิเศษที่ต้องการอนุญาตใน regex pattern
2. ปรับเปลี่ยนการแปลงตัวพิมพ์ (เช่น ไม่แปลงเป็นตัวพิมพ์เล็ก)
3. เพิ่มกฎการทำความสะอาดเพิ่มเติมตามความต้องการ
